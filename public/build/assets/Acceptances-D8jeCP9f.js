import{r as d,u as f,j as e,H as N}from"./app-drMYg6w5.js";import{A as v}from"./AppLayout-DkSna3jR.js";/* empty css            */function D({applications:c=[],flash:n,user:w}){const[b,l]=d.useState(!1),[r,i]=d.useState(null),[t,g]=d.useState(""),{data:S,setData:j,post:p,processing:o,errors:x,reset:m}=f({acceptance_file:null}),a=c.filter(s=>s.name.toLowerCase().includes(t.toLowerCase())||s.mobile.includes(t)||s.department.toLowerCase().includes(t.toLowerCase())),u=s=>{i(s),m(),l(!0)},y=s=>{s.preventDefault(),p(`/admin/applications/${r.id}/accept`,{forceFormData:!0,onSuccess:()=>{l(!1),i(null),m()}})};return e.jsxs(v,{children:[e.jsx(N,{title:"قبولات الطلاب"}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-white border-2 border-gray-300 shadow-sm",children:[e.jsx("div",{className:"bg-gray-100 border-b-2 border-gray-300 px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"قبولات الطلاب"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"إدارة القبولات النهائية للطلاب المعتمدين"})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:a.length}),e.jsx("span",{className:"text-gray-500 text-sm block",children:"طلب معتمد"})]})]})}),n?.message&&e.jsx("div",{className:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 m-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm",children:n.message})})]})}),e.jsx("div",{className:"p-6 border-b border-gray-300 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx("input",{type:"text",placeholder:"البحث بالاسم، الموبايل، أو القسم...",value:t,onChange:s=>g(s.target.value),className:"w-full px-3 py-2 border border-gray-300 focus:outline-none focus:border-blue-600"})}),e.jsxs("div",{className:"text-sm text-gray-600",children:["عرض ",a.length," من أصل ",c.length," طلب"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100 border-b border-gray-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"#"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"رقم الطلب"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"اسم الطالب"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"القسم"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"الجامعة"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"رقم الموبايل"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700 border-l border-gray-300",children:"تاريخ الاعتماد"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-700",children:"الإجراءات"})]})}),e.jsx("tbody",{children:a.length>0?a.map((s,h)=>e.jsxs("tr",{className:"border-b border-gray-300 hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 border-l border-gray-300",children:h+1}),e.jsx("td",{className:"p-4 border-l border-gray-300 font-mono text-sm",children:s.application_number}),e.jsx("td",{className:"p-4 border-l border-gray-300 font-medium",children:s.name}),e.jsx("td",{className:"p-4 border-l border-gray-300",children:s.department}),e.jsx("td",{className:"p-4 border-l border-gray-300",children:s.university?.name}),e.jsx("td",{className:"p-4 border-l border-gray-300 font-mono",children:s.mobile}),e.jsx("td",{className:"p-4 border-l border-gray-300",children:s.reviewed_at?new Date(s.reviewed_at).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[s.status==="approved"&&e.jsx("button",{onClick:()=>u(s),className:"px-3 py-1 bg-green-600 text-white text-sm hover:bg-green-700 transition-colors duration-200",children:"قبول نهائي"}),s.status==="accepted"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-sm border border-green-300",children:"✅ مقبول نهائياً"}),s.acceptance_file&&e.jsx("a",{href:`/application/${s.application_number}/acceptance-pdf`,target:"_blank",className:"px-3 py-1 bg-blue-600 text-white text-sm hover:bg-blue-700 transition-colors duration-200",children:"📄 تحميل PDF"})]})]})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"لا توجد طلبات معتمدة للقبول النهائي"})})})]})})]})}),b&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white border-2 border-gray-300 shadow-lg max-w-2xl w-full mx-4 max-h-screen overflow-y-auto",children:e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"bg-gray-100 border-b-2 border-gray-300 px-6 py-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"قبول نهائي للطالب"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"إرفاق ملف القبول وتأكيد القبول النهائي"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4",children:[e.jsx("h4",{className:"font-bold text-blue-800 mb-3",children:"معلومات الطالب"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"الاسم:"})," ",r.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"رقم الطلب:"})," ",r.application_number]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"القسم:"})," ",r.department]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"المرحلة:"})," ",r.stage]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"الجامعة:"})," ",r.university?.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"رقم الموبايل:"})," ",r.mobile]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملف القبول النهائي *"}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:s=>j("acceptance_file",s.target.files[0]),className:"w-full px-3 py-2 border border-gray-300 focus:outline-none focus:border-blue-600",required:!0}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-3 mt-2",children:[e.jsx("p",{className:"text-yellow-800 text-sm font-medium mb-1",children:"ملاحظات مهمة:"}),e.jsxs("ul",{className:"text-yellow-700 text-xs space-y-1",children:[e.jsx("li",{children:"• ارفق صورة أو ملف PDF لقرار القبول"}),e.jsx("li",{children:"• تأكد من وضوح الملف وقابليته للقراءة"}),e.jsx("li",{children:"• الحد الأقصى لحجم الملف: 5 ميجابايت"}),e.jsx("li",{children:"• سيتم إرسال هذا الملف للطالب عند الاستعلام"})]})]}),x.acceptance_file&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:x.acceptance_file})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 p-4",children:[e.jsxs("p",{className:"text-green-800 text-sm",children:[e.jsx("strong",{children:"تنبيه:"})," بعد تأكيد القبول النهائي:"]}),e.jsxs("ul",{className:"text-green-700 text-xs mt-2 space-y-1",children:[e.jsx("li",{children:"• سيتم إضافة الطالب إلى قاعدة بيانات الطلاب"}),e.jsx("li",{children:'• سيتمكن الطالب من الاستعلام ورؤية حالة "مقبول نهائياً"'}),e.jsx("li",{children:"• سيتمكن من تحميل ملف القبول"}),e.jsx("li",{children:"• لا يمكن التراجع عن هذا الإجراء"})]})]})]}),e.jsxs("div",{className:"bg-gray-100 border-t-2 border-gray-300 px-6 py-4 flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 bg-gray-500 text-white hover:bg-gray-600 transition-colors duration-200",children:"إلغاء"}),e.jsx("button",{type:"submit",disabled:o,className:"px-6 py-2 bg-green-600 text-white hover:bg-green-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"جاري المعالجة...":"تأكيد القبول النهائي"})]})]})})})]})}export{D as default};
